<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>RobStore - Productos</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Tienda RobStore</h1>
  <div id="product-list"></div>

<script>
const API = "https://ecommerce-django-production-39cb.up.railway.app/api/products/";

async function loadProducts() {
    const resp = await fetch(API);
    const data = await resp.json();

    const container = document.getElementById("product-list");
    container.innerHTML = "";

    data.forEach(prod => {
        container.innerHTML += `
            <div class="card">
                <h3>${prod.name}</h3>
                <p>${prod.description || ""}</p>
                <p><strong>$${prod.price}</strong></p>
                <button onclick="addToCart(${prod.id})">Agregar al carrito</button>
            </div>
        `;
    });
}

async function addToCart(productId) {
    const token = localStorage.getItem("token");

    if (!token) {
        alert("Debes iniciar sesi√≥n primero.");
        return;
    }

    await fetch("https://ecommerce-django-production-39cb.up.railway.app/api/cart/add/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
        },
        body: JSON.stringify({ product_id: productId, quantity: 1 })
    });

    alert("Producto agregado al carrito");
}

loadProducts();
</script>
</body>
</html>
